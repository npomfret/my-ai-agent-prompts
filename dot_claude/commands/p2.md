---
description: Smart router - asks advisors which tools to use, then executes with MCP servers or agents
---

# P2 Command (Smart Router)

**User Request**: $ARGUMENTS

First, use the Task tool to ask the MCP advisor:
Task(
    description="Check MCP servers",
    prompt="$ARGUMENTS",
    subagent_type="mcp-advisor"
)

Based on the MCP advisor's response:
- If it returns MCP server names (not "none"), use each suggested MCP server by saying what you're doing then adding the trigger (e.g., "I'll check the API documentation. use context7")
- If it returns "none", proceed to ask the agent advisor

If the MCP advisor returned "none", use the Task tool to ask the agent advisor:
Task(
    description="Check agents",
    prompt="$ARGUMENTS",
    subagent_type="agent-advisor"
)

Based on the agent advisor's response:
- If it returns agent names (not "none"), for each agent name returned:
  - Use the Task tool to invoke that specific agent with the original user request
  - Example: If advisor returns "auditor", then:
    Task(
        description="Review changes", 
        prompt="$ARGUMENTS",
        subagent_type="auditor"
    )
  - If multiple agents are returned (e.g., "code-quality-enforcer, auditor"), invoke each one separately
- If it returns "none", handle the request directly using built-in tools

Remember: Always check MCP servers first (they're faster), then agents, then fallback to built-in tools.